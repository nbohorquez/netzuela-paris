<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal">
<head>
    <title>Macros</title>
</head>
<body>
	
	<!-- Inventario de productos
	================================================== -->	
	<metal:inventario_de_productos define-macro="inventario_de_productos">
	    <ul class="thumbnails">
        	<li class="span2" tal:repeat="item lista">
        		<div tal:define="enlace view.peticion.route_url('producto', producto_id = item.producto_id)">
        			<a href="${enlace}">
        				<div class="thumbnail">
        					<img tal:define="foto view.obtener_foto('producto', item.producto_id, 'pequenas')" src="/estatico/${foto.ruta_de_foto}" alt="producto.nombre" />
        				</div>
        			</a>
        			<div class="caption" tal:define="producto view.obtener_producto(item.producto_id)">
						<a href="${enlace}">
							<h5>${producto.nombre}</h5>
						</a>
						<p>
							<em>${producto.codigo}</em><br />
							${item.descripcion}<br />
							<strong>Categoria</strong> <span tal:define="categoria_item view.obtener_categoria(producto.categoria)">${categoria_item.nombre}</span><br />
							<strong>SKU</strong> ${item.codigo}<br />
							<strong>Precio</strong> ${item.precio}<br />
							<strong>Cantidad</strong> ${item.cantidad}
						</p>
					</div>
	           	</div>
	        </li>
        </ul>
	</metal:inventario_de_productos>
	
	<!-- Inventario de tiendas
	================================================== -->	
	<metal:inventario_de_tiendas define-macro="inventario_de_tiendas">
	   <ul class="thumbnails">
        	<li class="span2" tal:repeat="item lista">
        		<div tal:define="enlace view.peticion.route_url('tienda', tienda_id = item.tienda_id)">
        			<a href="${enlace}">
        				<div class="thumbnail">
        					<img tal:define="foto view.obtener_foto('tienda', item.tienda_id, 'pequenas')" src="/estatico/${foto.ruta_de_foto}" alt="cliente.nombre_comun" />
        				</div>
        			</a>
        			<div class="caption" tal:define="cliente view.obtener_cliente_padre('tienda', item.tienda_id)">
						<a href="${enlace}">
							<h5>${cliente.nombre_comun}</h5>	
						</a>
						<p tal:define="tienda view.obtener_tienda(item.tienda_id)">
							${cliente.nombre_legal}
							<span class="label label-success" tal:condition="tienda.abierto">Abierta</span>
							<span class="label label-important" tal:condition="not tienda.abierto">Cerrada</span>
							<br />
							<em>${cliente.rif}</em><br />
							<strong>Categoria</strong> <span tal:define="categoria_item view.obtener_categoria(cliente.categoria)">${categoria_item.nombre}</span><br />					
							<strong>Precio</strong> ${item.precio}<br />
							<strong>Cantidad</strong> ${item.cantidad}
							<input type="hidden" name="tienda_id" value="${tienda.tienda_id}" />
						</p>
					</div>
	           	</div>
	        </li>
        </ul>
	</metal:inventario_de_tiendas>
	
	<!-- Comentarios (calificaciones y reseñas)
	================================================== -->	
	<metal:comentarios define-macro="comentarios">
		<blockquote tal:repeat="comentario view.calificaciones_resenas">
			<p>${comentario.resena}</p>
			<small>
				${comentario.consumidor.nombre} ${comentario.consumidor.apellido} el ${comentario.fecha}
				<tal:block tal:switch="comentario.calificacion">
					<span tal:case="'Bien'"><i class="icon-thumbs-up"></i></span>
					<span tal:case="'Mal'"><i class="icon-thumbs-down"></i></span>									
    			</tal:block>
			</small>
		</blockquote>
	</metal:comentarios>
	
	<!-- Fotos
	================================================== -->	
	<metal:fotos_medianas define-macro="fotos_medianas">
		<div id="carrusel" class="carousel slide">
            <div class="carousel-inner">
            	<tal:block tal:repeat="foto view.fotos_medianas">
           			<div tal:condition="repeat.foto.start" class="item active">
        				<div class="thumbnail">
        					<img src="/estatico/${foto.ruta_de_foto}" alt="Foto" />
        				</div>
        			</div>
        			<div tal:condition="not repeat.foto.start" class="item">
        				<div class="thumbnail">
        					<img src="/estatico/${foto.ruta_de_foto}" alt="Foto" />
        				</div>
        			</div>
            	</tal:block>
			</div>
			<tal:block tal:condition="python:len(view.fotos_medianas) > 1">
	        	<a class="left carousel-control" href="#carrusel" data-slide="prev">&lsaquo;</a>
	        	<a class="right carousel-control" href="#carrusel" data-slide="next">&rsaquo;</a>
        	</tal:block>
        </div>
	</metal:fotos_medianas>
	
	<!-- Ruta de categoria
	================================================== -->	
	<metal:ruta_de_categoria define-macro="ruta_de_categoria">
		<ul id="ruta_de_categoria" class="breadcrumb">
			<li tal:repeat="nodo view.ruta_categoria_actual">
		    	<a tal:condition="pagina == 'Producto'" tal:attributes="href view.peticion.route_url('productos', categoria_id = nodo.categoria_id, territorio_id = '0.02.00.00.00.00')">${nodo.nombre}</a> 
		    	<a tal:condition="pagina == 'Tienda'" tal:attributes="href view.peticion.route_url('tiendas', categoria_id = nodo.categoria_id, territorio_id = '0.02.00.00.00.00')">${nodo.nombre}</a>
		    	<span class="divider">/</span>
		  	</li>
		  	<li tal:condition="pagina == 'Producto'" class="active">${producto.fabricante} ${producto.nombre}</li>
		  	<li tal:condition="pagina == 'Tienda'" class="active">${cliente.nombre_comun}</li>
		</ul>
	</metal:ruta_de_categoria>
	
	<!-- Enlace de categoria
	================================================== -->	
	<metal:enlace_categoria define-macro="enlace_categoria">
		<a tal:condition="pagina == 'Productos'" tal:attributes="href view.peticion.route_url('productos', categoria_id = categoria.categoria_id, territorio_id = view.territorio_id)">${categoria.nombre}</a>
		<a tal:condition="pagina == 'Tiendas'" tal:attributes="href view.peticion.route_url('tiendas', categoria_id = categoria.categoria_id, territorio_id = view.territorio_id)">${categoria.nombre}</a>
	</metal:enlace_categoria>
	
	<!-- Enlace de ubicacion
	================================================== -->	
	<metal:enlace_ubicacion define-macro="enlace_ubicacion">
		<a tal:condition="pagina == 'Productos'" tal:attributes="href view.peticion.route_url('productos', categoria_id = view.categoria_id, territorio_id = region.territorio_id)">${region.nombre}</a>
		<a tal:condition="pagina == 'Tiendas'" tal:attributes="href view.peticion.route_url('tiendas', categoria_id = view.categoria_id, territorio_id = region.territorio_id)">${region.nombre}</a>
	</metal:enlace_ubicacion>

	<!-- Noticias
	================================================== -->
	<metal:noticias define-macro="noticias">
		<table class="table">
  			<tbody>
	    		<tr tal:repeat="registro view.registro">
	    			<td>
	    				<div class="row-fluid">
	    					<div class="span1.5">
	    						<a href="${registro.actor_activo.href}">
		    						<div class="thumbnail">
	        							<img src="/estatico/${registro.actor_activo.foto}" alt="foto actor activo" />
	        						</div>
	        					</a>
	    					</div>
	    					<div class="span10.5">
		    					<p>
			    					<tal:block tal:switch="registro.accion">
										<i tal:case="'inserto'" class="icon-plus"></i>
										<i tal:case="'abrio'" class="icon-eye-open"></i>
										<i tal:case="'actualizo'" class="icon-pencil"></i>
										<i tal:case="'elimino'" class="icon-trash"></i>
										<i tal:case="'bloqueo'" class="icon-lock"></i>
										<i tal:case="'abrio sesion'" class="icon-user"></i>
										<i tal:case="'cerro sesion'" class="icon-off"></i>
									</tal:block>
									<a tal:attributes="href registro.actor_activo.href">${registro.actor_activo.nombre}</a> 
									${registro.accion}
									<a tal:attributes="href registro.actor_pasivo.href">${registro.actor_pasivo.nombre}</a>
								</p>
								<h5>${registro.actor_pasivo.titulo}</h5>
								<table class="table">
									<tbody>
										<tr>
											<td>
												<img src="/estatico/${registro.actor_pasivo.foto}" alt="foto actor pasivo" />
											</td>
											<td>
							    				<p><span tal:repeat="columna registro.columnas">${columna}<br /></span></p>
											</td>
											<td>
										  		<p><span tal:repeat="valor registro.contenido">${valor}<br /></span></p>
										  	</td>
										</tr>
									</tbody>
								</table>
								<p><small>hace ${registro.tiempo}</small></p>
							</div>
	    				</div>
	    			</td>
  				</tr>
  			</tbody>
		</table>
	</metal:noticias>
	
	<!-- Ingresar
	================================================== -->	
	<metal:ingresar define-macro="ingresar">
		<form action="/ingresar" method="post" accept-charset="UTF-8">
		  	<input type="text" name="usuario" style="margin-bottom: 15px;" size="30" placeholder="Correo electrónico" />
			<input type="password" name="contrasena" style="margin-bottom: 15px;" size="30" placeholder="Contraseña" />
			<label class="checkbox">
				<input type="checkbox" name="recordame" />
				Recordame
			</label>
		 	<input class="btn btn-primary" type="submit" name="ingresar" style="clear: left; width: 100%; height: 32px; font-size: 13px;" value="Ingresar" />
		</form>
	</metal:ingresar>	
</body>
</html>