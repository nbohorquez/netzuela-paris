<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      metal:define-macro="diagrama_global">
<head>
    <title>Netzuela - ${pagina}</title>
    <link rel="stylesheet" href="/estatico/css/bootstrap.css"/>
    <link rel="stylesheet" href="/estatico/css/bootstrap-responsive.css" />
    <link rel="stylesheet" href="/estatico/css/netzuela.css" />
    <!-- <link rel="stylesheet" href="/estatico/css/font-awesome.css" /> -->
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <div id="meta_datos">
		<input type="hidden" name="pagina" value="${pagina}" />
		<div metal:define-slot="extra_meta_datos"></div>
	</div>    
</head>
<body>
	
	<!-- Barra superior
	================================================== -->
  	<div class="navbar navbar-fixed-top">
		<div class="navbar-inner">
			<div class="container">
				<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          			<span class="icon-bar"></span>
          			<span class="icon-bar"></span>
          			<span class="icon-bar"></span>
        		</a>
        		<a class='brand' tal:attributes="href view.peticion.route_url('inicio')" title='Tu mundo en tiempo real'>
            		<img alt='Logo de Netzuela' height='16' src='/estatico/img/Netzuela-w-.png' width='83' />
          		</a>
        		<div class="nav-collapse">
	        		<ul id="navegacion" class="nav">
						<li><a tal:attributes="href view.peticion.route_url('productos', categoria_id = '0.00.00.00.00.00', territorio_id =  '0.02.00.00.00.00')">Productos</a></li>
						<li><a tal:attributes="href view.peticion.route_url('tiendas', categoria_id = '0.00.00.00.00.00', territorio_id =  '0.02.00.00.00.00')">Tiendas</a></li>
					</ul>
					<form class="navbar-search pull-left" action="">
						<input type="text" class="search-query" placeholder="Búsqueda" />
						<i class="icon-search icon-white"></i>
          			</form>
					<ul class="nav pull-right" tal:condition="exists:autentificado">
						<li class="dropdown" tal:condition="not autentificado">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown" data-target="#">
								Ingresar
								<b class="caret"></b>
							</a>							
							<div class="dropdown-menu" style="padding: 15px; padding-bottom: 0px;">
								<form tal:attributes="action view.peticion.route_url('ingresar')" method="post" accept-charset="UTF-8">
									<input type="hidden" name="pagina_anterior" value="${view.pagina_actual}" />
								  	<input type="text" name="usuario" class="input-large" placeholder="Correo electrónico" />
									<input type="password" name="contrasena" class="input-large" placeholder="Contraseña" />
									<label class="checkbox">
										<input type="checkbox" name="recordame" />
										Recordame
									</label>
								 	<input class="btn btn-primary" type="submit" name="ingresar" value="Ingresar" />
								 	<input class="btn" type="submit" name="registrarse" value="No tengo cuenta" />
								</form>
							</div>
						</li>
						<li class="dropdown" tal:condition="autentificado" tal:define="usuario view.obtener_usuario('correo_electronico', autentificado)">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown" data-target="#">
								<span tal:content="'{0} {1}'.format(usuario.nombre, usuario.apellido)"></span>
								<b class="caret"></b>
							</a>
							<ul class="dropdown-menu">
								<li><a tal:attributes="href view.peticion.route_url('usuario', usuario_id = usuario.usuario_id)"><i class="icon-user"></i> Ver perfil</a></li>
								<li class="divider"></li>
								<li><a tal:attributes="href view.peticion.route_url('configuracion')"><i class="icon-cog"></i> Configuración</a></li>
								<li><a tal:attributes="href view.peticion.route_url('salir')"><i class="icon-off"></i> Cerrar sesión</a></li>
							</ul>
						</li>
					</ul>
        		</div>
			</div>
		</div>
	</div>		

	<div class="container-fluid">
		
		<!-- Cuerpo principal
		================================================== -->		
		<div class="row-fluid">
			
			<div class="span2">
				
				<!-- Menu lateral
				================================================== -->
				
				<div class="well" style="padding: 8px 0;">
					<ul id="categorias" class="nav nav-list treeview" tal:condition="pagina == 'Productos' or pagina == 'Tiendas'">
						<li class="nav-header">Categorías</li>
						<tal:block tal:repeat="categoria view.ruta_categoria_actual">
							<li class="active nodo_padre" tal:condition="categoria.categoria_id == view.categoria_id">
								<div metal:use-macro="view.macros['enlace_categoria']"></div>
							</li>
							<li class="nodo_padre" tal:condition="categoria.categoria_id != view.categoria_id">
								<div metal:use-macro="view.macros['enlace_categoria']"></div>
							</li>
						</tal:block>
						<tal:block tal:repeat="categoria view.categorias_hijas">
							<li class="nodo_hijo">
								<div metal:use-macro="view.macros['enlace_categoria']"></div>
							</li>
						</tal:block>
					</ul>
					<ul id="ubicacion" class="nav nav-list treeview" tal:condition="pagina == 'Productos' or pagina == 'Tiendas'">
						<li class="nav-header">Ubicación</li>
						<tal:block tal:repeat="region view.ruta_territorio_actual">
							<li class="active nodo_padre" tal:condition="region.territorio_id == view.territorio_id">
								<div metal:use-macro="view.macros['enlace_ubicacion']"></div>
							</li>
							<li class="nodo_padre" tal:condition="region.territorio_id != view.territorio_id">
								<div metal:use-macro="view.macros['enlace_ubicacion']"></div>
							</li>
						</tal:block>
						<tal:block tal:repeat="region view.territorios_hijos">
							<li class="nodo_hijo">
								<div metal:use-macro="view.macros['enlace_ubicacion']"></div>
							</li>
						</tal:block>
					</ul>
					<ul id="menu" class="nav nav-list" tal:condition="pagina == 'Producto' or pagina == 'Tienda' or pagina == 'Usuario'">
					  	<li class="nav-header">Menú</li>
					  	<li class="active">
					  		<a href="#informacion" data-toggle="tab">
					  			<i class="icon-list-alt"></i>
					  			Información					  			
					  		</a>
					  	</li>
					  	<li>
					  		<a href="#comentarios" data-toggle="tab">
						  		<i class="icon-comment"></i>
						  		Comentarios
					  		</a>
					  	</li>
					</ul>
					<ul class="nav nav-list">
					  	<li class="divider"></li>
          				<li>
          					<a href="#">
          						<i class="icon-flag"></i>
          						Ayuda
          					</a>
          				</li>
          			</ul>
				</div>
				
				<!-- Gadget lateral
				================================================== -->
				<div id="gadget2" class="accordion-group">
              		<div id="gadget2_encabezado" class="accordion-heading">
                		<a class="accordion-toggle" data-toggle="collapse" href="#gadget2_colapsable">
		                  	<i></i>
		                  	Historial
                		</a>
					</div>
              		<div id="gadget2_colapsable" class="accordion-body collapse in">
              			<div id="historial"></div>
              		</div>
            	</div>
			</div>
          
			<!-- Zona central
			================================================== -->
			<div class="span10">
				<div id="gadget1" class="accordion-group">
              		<div id="gadget1_encabezado" class="accordion-heading">
                		<a class="accordion-toggle" data-toggle="collapse" href="#gadget1_colapsable">
		                  	<i></i>
		                  	Mapa
                		</a>
					</div>
              		<div id="gadget1_colapsable" class="accordion-body collapse in">
              			<div id="mapa"></div>
              		</div>
            	</div>
	           	<div id="principal">
					<div metal:define-slot="contenido"></div>	                  
				</div>
			</div>
		</div>
		
		<hr />
			
		<!-- Barra inferior
		================================================== -->
		<footer class="pull-right">
			<p>
				<span><a href="/acerca">Sobre nosotros</a></span>
				<span><a href="/publicidad">Publicidad</a></span>
				<span><a href="/desarrolladores">Desarrolladores</a></span>
				<span><a href="/empleo">Empleo</a></span>
				<span><a href="/condiciones">Condiciones</a></span>
				<span><a href="/ayuda">Ayuda</a></span>
				<span>&copy 2012 Zuliaworks</span>
			</p>
		</footer>
	</div>
	
	<!-- Scripts (colocados aqui para que la pagina cargue mas rapido)
	================================================================== -->
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
	<script	type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
	<!--<script type="text/javascript" src="/estatico/js/outerHtml.js"></script>-->
	<script type="text/javascript" src="/estatico/js/jquery.flot.min.js"></script>
	<script type="text/javascript" src="/estatico/js/bootstrap-tab.js"></script>
    <script type="text/javascript" src="/estatico/js/bootstrap-collapse.js"></script>
    <script type="text/javascript" src="/estatico/js/bootstrap-dropdown.js"></script>
    <script type="text/javascript" src="/estatico/js/EventObject.js"></script>
    <script type="text/javascript" src="/estatico/js/infobox.js"></script>
    <script type="text/javascript" src="/estatico/js/google_map.js"></script>
    <script type="text/javascript" src="/estatico/js/historial.js"></script>
    <script type="text/javascript" src="/estatico/js/global.js"></script>    
    <script type="text/javascript" src="/estatico/js/territorio.js"></script>
    <script type="text/javascript" src="/estatico/js/mapa.js"></script>
    <div id="scripts" metal:define-slot="scripts_extra"></div>
    <script type="text/javascript">
    	$.extend($.fn.datepicker.defaults, {
			parse: function (string) {
		  		var matches;
		  		if ((matches = string.match(/^(\d{2,2})\/(\d{2,2})\/(\d{4,4})$/))) {
		        	return new Date(matches[3], matches[2] - 1, matches[1]);
		  		} else {
		            return null;
		      	}
			},
			format: function (date) {
		    	var month = (date.getMonth() + 1).toString(), dom = date.getDate().toString();
		  		if (month.length === 1) {
		          	month = "0" + month;
		    	}
		  		if (dom.length === 1) {
		          	dom = "0" + dom;
		  		}
		  		return dom + "/" + month + "/" + date.getFullYear();
			}
		});
    	$(document).ready(function () {
			// No escribais nada despues de estas lineas porque el javascript no lo va a ejecutar
			// No se por que...
			$(".collapse").collapse();
			$('.carousel').carousel();
			/* Cambio el formato de la fecha a dd/mm/aaaa */
    	});
    </script>
</body>
</html>